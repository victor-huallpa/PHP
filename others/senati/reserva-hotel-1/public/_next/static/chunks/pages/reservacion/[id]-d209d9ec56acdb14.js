(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[886],{2825:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reservacion/[id]",function(){return s(3893)}])},4011:function(e,a,s){"use strict";var t=s(6154);let l=t.Z.create({baseURL:"http://localhost/proyects/api-king-hotel/public/api/"});a.Z=l},5740:function(e,a,s){"use strict";function t(){$(document).on("click","#mainSidebarToggle",function(e){e.preventDefault(),$("body.horizontalmenu").toggleClass("main-navbar-show")}),$(".main-menu .with-sub").on("click",function(e){var a=$(this),s=a.next(),t=".nav-sub";if(s.is(t)&&s.is(":visible"))s.slideUp(300,function(){s.removeClass("open")}),s.parent("li").removeClass("show");else if(s.is(t)&&!s.is(":visible")){var l=a.parents("ul").first();l.find("ul:visible").slideUp(300).removeClass("open");var i=a.parent("li");s.slideDown(300,function(){s.addClass("open"),l.find("li.show").removeClass("show"),i.addClass("show")})}s.is(t)&&e.preventDefault()}),$(".main-menu .sub-with-sub").on("click",function(e){var a=$(this),s=a.next(),t=".sub-nav-sub";if(s.is(t)&&s.is(":visible"))s.slideUp(300,function(){s.removeClass("open")}),s.parent("li").removeClass("show");else if(s.is(t)&&!s.is(":visible")){var l=a.parents("ul").first();l.find("ul:visible").slideUp(300).removeClass("open");var i=a.parent("li");s.slideDown(300,function(){s.addClass("open"),l.find("li.show").removeClass("show"),i.addClass("show")})}s.is(t)&&e.preventDefault()});let e=!1;$(".main-profile-menu").on("click",function(a){!0==e?($("#user_menu").removeClass("show"),e=!1):($("#user_menu").addClass("show"),e=!0)})}s.d(a,{O:function(){return t}})},3893:function(e,a,s){"use strict";s.r(a);var t=s(5893),l=s(7294),i=s(4102),n=s(9109),c=s(3907),r=s(6993),d=s(9897),o=s(1029),m=s(1163),u=s(4011),h=s(5740);let v=s(4184);a.default=function(){let e=(0,m.useRouter)(),a=e.query.id,[p,x]=(0,l.useState)({nivel:{}}),[b,f]=(0,l.useState)({nivel:{}}),[j,N]=(0,l.useState)(!0),[g,y]=(0,l.useState)(!1),[C,w]=(0,l.useState)(""),[S,E]=(0,l.useState)(""),[R,A]=(0,l.useState)(0),[O,D]=(0,l.useState)(""),[I,_]=(0,l.useState)([]);async function k(e){let a={...b};a.title=e.target.value,f(a)}async function Z(e){let a={...b};a.precio=e.target.value,f(a)}async function F(e){if(Number(e.target.value)<=b.precio*b.days){let a={...b};a.adelanto=Number(e.target.value),f(a)}}async function T(e){let a={...b};a.active=e.target.value,f(a)}async function B(e){E(e.target.value)}async function L(e){A(e.target.value)}async function U(){try{let e={start:C,end:O,title:S,habitacion_id:p.id,precio:R};await u.Z.post("reservacions",e),E("");let s=await u.Z.get("habitacions/"+a);x(s.data),_(s.data.reservacions)}catch(e){}}async function P(e){var t=s(381);let l=t(e.event.startStr),i=t(e.event.endStr),n=I.filter(a=>{let s=t(a.start),n=t(a.end);return e.event.id!=a.id&&l.isSameOrAfter(s)&&l.isBefore(n)||e.event.id!=a.id&&i.isSameOrAfter(s)&&i.isBefore(n)});if(n.length>0)return notif({type:"info",msg:"Ya hay reservaciones en esa fecha",position:"center"}),e.revert(),!1;let c=e.event._def,r={end:e.event.endStr,start:e.event.startStr};await u.Z.put("reservacions/"+c.publicId,r),notif({type:"success",msg:"Se ha modificado el rango de reservaci\xf3n correctamente!",position:"center"});let d=await u.Z.get("habitacions/"+a);x(d.data),_(d.data.reservacions)}async function V(){let e=localStorage.getItem("hk.user");e=JSON.parse(e);let s={...b};s.caja_id=e.caja.id,await u.Z.put("reservacions-reajuste/"+b.id,s),notif({type:"success",msg:"Se ha actualizado correctamente!",position:"center"});let t=await u.Z.get("habitacions/"+a);x(t.data),_(t.data.reservacions)}async function M(e){var t=s(381);let l=e.event._def,i=t(e.event.startStr),n=t(e.event.endStr),c=I.filter(a=>{let s=t(a.start),l=t(a.end);return e.event.id!=a.id&&i.isSameOrAfter(s)&&i.isBefore(l)||e.event.id!=a.id&&n.isSameOrAfter(s)&&n.isBefore(l)});if(c.length>0)return notif({type:"info",msg:"Ya hay reservaciones en esa fecha",position:"center"}),e.revert(),!1;let r={end:e.event.endStr,start:e.event.startStr};await u.Z.put("reservacions/"+l.publicId,r),notif({type:"success",msg:"Se ha movido la fecha correctamente!",position:"center"});let d=await u.Z.get("habitacions/"+a);x(d.data),_(d.data.reservacions)}return(0,l.useEffect)(()=>{N(!0),(0,h.O)();let e=async()=>{try{let e=await u.Z.get("habitacions/"+a);x(e.data),_(e.data.reservacions),A(e.data.precio)}catch(e){}finally{N(!1)}};e()},[a]),(0,t.jsxs)(n.Z,{modulo:"Setting",page:"Categorias",children:[j?(0,t.jsxs)("div",{id:"global-loader",children:[" ",(0,t.jsx)("img",{src:"/assets/loader.svg",className:"loader-img",alt:"Loader"})," "]}):"",(0,t.jsxs)("div",{className:"page-header",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"main-content-title tx-24 mg-b-5",children:["Habitacion ",p.name]}),(0,t.jsxs)("ol",{className:"breadcrumb",children:[(0,t.jsx)("li",{className:"breadcrumb-item",children:(0,t.jsx)("a",{href:"#",children:"Reservacion"})}),(0,t.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:p.nivel.name})]})]}),(0,t.jsx)("div",{className:"d-flex",children:(0,t.jsx)("div",{className:"justify-content-center"})})]}),(0,t.jsx)("div",{className:"row row-sm",children:(0,t.jsx)("div",{className:"col-md-12 col-lg-12",children:(0,t.jsxs)("div",{className:"card custom-card",children:[(0,t.jsx)("div",{className:"card-header  border-bottom-0 pb-0",children:(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"d-flex",children:(0,t.jsxs)("label",{className:"main-content-label my-auto pt-2",children:["Reservaciones de la habitac\xedon ",p.name]})})})}),(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsx)("div",{className:"modal ",id:"modalModel",role:"dialog",children:(0,t.jsx)("div",{className:"modal-dialog modal-md",role:"document",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsx)("h6",{className:"modal-title",children:"INICIAR RESERVACION"}),(0,t.jsx)("button",{"aria-label":"Close",className:"btn-close","data-bs-dismiss":"modal",type:"button"})]}),(0,t.jsx)("div",{className:"modal-body",children:(0,t.jsxs)("div",{className:"row",children:[(0,t.jsxs)("div",{className:"col-12 mb-2",children:[(0,t.jsx)("label",{htmlFor:"",children:"TITULO"}),(0,t.jsx)("input",{className:" form-control",value:S,onChange:B})]}),(0,t.jsxs)("div",{className:"col-12 mb-2",children:[(0,t.jsx)("label",{htmlFor:"",children:"PRECIO"}),(0,t.jsx)("input",{className:" form-control",value:R,onChange:L})]}),(0,t.jsxs)("div",{className:"col-12 mb-2",children:[(0,t.jsx)("label",{htmlFor:"",children:"FECHA DE RESERVA"}),(0,t.jsx)("input",{className:" form-control",value:C,readOnly:!0})]})]})}),(0,t.jsxs)("div",{className:"modal-footer justify-content-end",children:[(0,t.jsx)("button",{className:"btn ripple btn-secondary","data-bs-dismiss":"modal",type:"button",children:"CERRAR"}),(0,t.jsx)("button",{className:"btn ripple btn-primary",type:"button",onClick:U,"data-bs-dismiss":"modal",children:"GUARDAR"})]})]})})}),(0,t.jsx)("div",{className:"modal ",id:"modalModelEdit",role:"dialog",children:(0,t.jsx)("div",{className:"modal-dialog modal-lg",role:"document",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsx)("h6",{className:"modal-title",children:"DETALLE DE RESERVACION"}),(0,t.jsx)("button",{"aria-label":"Close",className:"btn-close","data-bs-dismiss":"modal",type:"button"})]}),(0,t.jsx)("div",{className:"modal-body",children:(0,t.jsxs)("div",{className:"row",children:[(0,t.jsxs)("div",{className:"col-12 mb-2",children:[(0,t.jsx)("label",{htmlFor:"",children:"TITULO"}),(0,t.jsx)("input",{className:" form-control",value:b.title,onChange:k})]}),(0,t.jsxs)("div",{className:"col-4 mb-2",children:[(0,t.jsx)("label",{htmlFor:"",children:"INICIO DE RESERVA"}),(0,t.jsx)("input",{className:" form-control",value:b.start,readOnly:!0})]}),(0,t.jsxs)("div",{className:"col-4 mb-2",children:[(0,t.jsx)("label",{htmlFor:"",children:"FIN DE RESERVA"}),(0,t.jsx)("input",{className:" form-control",value:b.end,readOnly:!0})]}),(0,t.jsxs)("div",{className:"col-4 mb-2",children:[(0,t.jsx)("label",{htmlFor:"",children:"PRECIO"}),(0,t.jsx)("input",{className:" form-control",value:b.precio,onChange:Z})]}),(0,t.jsxs)("div",{className:"col-6 mb-2",children:[(0,t.jsx)("label",{htmlFor:"",children:"DIAS DE RESERVA"}),(0,t.jsx)("input",{className:" form-control",value:b.days,readOnly:!0})]}),(0,t.jsxs)("div",{className:"col-6 mb-2",children:[(0,t.jsx)("label",{htmlFor:"",children:"AGREGAR ADELANTO"}),(0,t.jsx)("input",{className:" form-control",value:b.adelanto,onChange:F,r:!0})]}),(0,t.jsx)("div",{className:"col-lg-4 col-xl-4",children:(0,t.jsx)("div",{className:"card border custom-card",children:(0,t.jsx)("div",{className:"card-body",children:(0,t.jsxs)("div",{className:"d-flex",children:[(0,t.jsx)("span",{className:"crypto-icon bg-primary-transparent me-3 my-auto",children:(0,t.jsx)("i",{className:"fas fa-wallet text-primary"})}),(0,t.jsxs)("div",{className:"",children:[(0,t.jsx)("p",{className:"text-uppercase tx-13 text-muted mb-1",children:"Balance"}),(0,t.jsxs)("h5",{className:"",children:[Number(b.precio*b.days).toFixed(2),(0,t.jsx)("span",{className:"tx-14 text-muted font-weight-normal ms-1",children:"BTC"})]})]})]})})})}),(0,t.jsx)("div",{className:"col-lg-4 col-xl-4",children:(0,t.jsx)("div",{className:"card border custom-card",children:(0,t.jsx)("div",{className:"card-body",children:(0,t.jsxs)("div",{className:"d-flex",children:[(0,t.jsx)("span",{className:"crypto-icon bg-primary-transparent me-3 my-auto",children:(0,t.jsx)("i",{className:"fas fa-wallet text-primary"})}),(0,t.jsxs)("div",{className:"",children:[(0,t.jsx)("p",{className:"text-uppercase tx-13 text-muted mb-1",children:"Balance"}),(0,t.jsxs)("h5",{className:"",children:[Number(b.adelantoSum).toFixed(2),(0,t.jsx)("span",{className:"tx-14 text-muted font-weight-normal ms-1",children:"BTC"})]})]})]})})})}),(0,t.jsx)("div",{className:"col-lg-4 col-xl-4",children:(0,t.jsx)("div",{className:"card border custom-card",children:(0,t.jsx)("div",{className:"card-body",children:(0,t.jsxs)("div",{className:"d-flex",children:[(0,t.jsx)("span",{className:"crypto-icon bg-primary-transparent me-3 my-auto",children:(0,t.jsx)("i",{className:"fas fa-wallet text-primary"})}),(0,t.jsxs)("div",{className:"",children:[(0,t.jsx)("p",{className:"text-uppercase tx-13 text-muted mb-1",children:"Balance"}),(0,t.jsxs)("h5",{className:"",children:[Number(b.precio*b.days-b.adelantoSum-b.adelanto).toFixed(2),(0,t.jsx)("span",{className:"tx-14 text-muted font-weight-normal ms-1",children:"BTC"})]})]})]})})})}),(0,t.jsx)("div",{className:"col-lg-12",children:(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("p",{className:"mb-2",children:"ESTADO DE RESERVA"}),(0,t.jsxs)("div",{className:"selectgroup selectgroup-pills",children:[(0,t.jsxs)("label",{className:"selectgroup-item",children:[(0,t.jsx)("input",{type:"radio",name:"active-value",value:"1",className:"selectgroup-input",checked:1==b.active,onChange:T}),(0,t.jsx)("span",{className:"selectgroup-button",children:"PENDIENTE"})]}),(0,t.jsxs)("label",{className:"selectgroup-item",children:[(0,t.jsx)("input",{type:"radio",name:"active-value",value:"2",className:"selectgroup-input",checked:2==b.active,onChange:T}),(0,t.jsx)("span",{className:"selectgroup-button",children:"CON ADELANTO"})]}),(0,t.jsxs)("label",{className:"selectgroup-item",children:[(0,t.jsx)("input",{type:"radio",name:"active-value",value:"3",className:"selectgroup-input",checked:3==b.active,onChange:T}),(0,t.jsx)("span",{className:"selectgroup-button",children:"CONFIRMADO"})]}),(0,t.jsxs)("label",{className:"selectgroup-item",children:[(0,t.jsx)("input",{type:"radio",name:"active-value",value:"0",className:"selectgroup-input",checked:0==b.active,onChange:T}),(0,t.jsx)("span",{className:"selectgroup-button",children:"BAJA"})]})]})]})})]})}),(0,t.jsxs)("div",{className:"modal-footer justify-content-end",children:[(0,t.jsx)("button",{className:"btn ripple btn-secondary","data-bs-dismiss":"modal",type:"button",children:"CERRAR"}),(0,t.jsx)("button",{className:"btn ripple btn-primary",type:"button",onClick:V,"data-bs-dismiss":"modal",children:"GUARDAR"})]})]})})}),(0,t.jsx)(c.Z,{plugins:[r.Z,d.ZP,o.Z],initialView:"dayGridMonth",dateClick:function(e){let a=s(381),t=a(e.dateStr);if(a(new Date).isAfter(t))return notif({type:"error",msg:"No puedes reservar en una fecha pasada",position:"center"}),!1;let l=I.filter(e=>{let s=a(e.start),l=a(e.end);return t.isSameOrAfter(s)&&t.isBefore(l)});if(l.length>0)notif({type:"info",msg:"Ya hay reservaciones en esa fecha",position:"center"});else{let{Modal:a}=s(8877),t=new a("#modalModel");t.show(),w(e.dateStr),D(e.dateStr)}},events:I,locale:i.Z,timeZone:"America/Lima",editable:!0,selectable:!0,droppable:!0,eventContent:function(e){let a=e.event._def.extendedProps.active;var s=v({"bg-danger":0==a,"bg-success":2==a,"bg-warning":3==a,"bg-dark":1==a});return(0,t.jsx)("div",{className:s,children:(0,t.jsxs)("div",{className:"p-2",children:[" ",(0,t.jsx)("i",{className:"fa fa-calendar","aria-label":"fa fa-calendar"})," ",e.event.title," ",(0,t.jsxs)("small",{children:["(",{0:"Baja",1:"Pendiente",2:"Con adelanto",3:"Confirmado"}[a],")"]})]})})},eventClick:function(e){f([...I].find(a=>a.id==e.event._def.publicId));let{Modal:a}=s(8877),t=new a("#modalModelEdit");t.show()},eventResize:P,eventDrop:M})]})]})})})]})}}},function(e){e.O(0,[885,69,827,245,877,787,370,109,774,888,179],function(){return e(e.s=2825)}),_N_E=e.O()}]);